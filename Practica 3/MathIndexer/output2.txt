
Journal of Computational and Applied Mathematics 311 (2017) 529–538

Contents lists available at ScienceDirect

Journal of Computational and Applied
Mathematics

journal homepage: www.elsevier.com/locate/cam

Construction of a full row-rank matrix system for multiple
scanning directions in discrete tomography
Xiezhang Li a,∗, James Diffenderfer b, Jiehua Zhu a
a Department of Mathematical Sciences, Georgia Southern University, Statesboro, GA 30460, USA
b Department of Mathematics, University of Florida, Gainesville, FL 32611, USA

a r t i c l e i n f o

Article history:
Received 16 November 2015
Received in revised form 17 June 2016

Keywords:
Strip-based projection model
Full row-rank system
Minimal linearly dependent

a b s t r a c t

A full row-rank system matrix generated by scans along two directions in discrete
tomography was recently studied. In this paper, we generalize the result to multiple
directions. Let Ax = h be a reduced binary linear system generated by scans along three
directions. Using geometry, it is shown in this paper that the linearly dependent rows of
the systemmatrix A can be explicitly identified and a full row-rank matrix can be obtained
after the removal of those rows. The results could be extended to any number of multiple
directions. Therefore, certain software packages requiring a full row-rank system matrix
can be adopted to reconstruct an image. Meanwhile, the cost of computation is reduced by
using a full row-rank matrix.

© 2016 Elsevier B.V. All rights reserved.

1. Introduction

The algebraic reconstruction of an image in discrete tomography from the projections in a few directions involves solving
an underdetermined linear system of projection equations

Mx = b, (1)

where M is an m × n2 matrix, x ∈ Rn2 a reconstructed image vector for an n × n 2-dimensional image and b ∈ Rm
the projection vector. The projection equations are formulated from projection data based on different models. The strip-
based projection model [1–4] formulates projection equations according to the fractional areas where each strip-shaped
beam intersects with the rectangular lattice of the image to be reconstructed. Thus, it is more realistic than the line-based
projection model used in some applications. The twomatrices of systems (1) generated by the two projection models along
the same direction set are proven to be row equivalent [4].

The l1-minimization algorithm has been applied to reconstruct an image from the underdetermined system (1) [5,6]. A
full row-rank system reduces the cost for solving the system and it is required for the usage of some current l1-minimization
software packages, such as the l1-magic and the sparselab software packages [7,8]. However, thematrixM is often row-rank
deficient so it is desired to convert the matrixM into a full row-rank matrix.

Consider an n × n 2-dimensional image f defined on a lattice set

Ω = {(u, v)|0 ≤ u, v ≤ n − 1, u, v ∈ Z}

∗ Corresponding author.
E-mail address: xli@georgiasouthern.edu (X. Li).

http://dx.doi.org/10.1016/j.cam.2016.08.039
0377-0427/© 2016 Elsevier B.V. All rights reserved.









530 X. Li et al. / Journal of Computational and Applied Mathematics 311 (2017) 529–538

of n2 lattice points. Suppose that the n2 lattice points of Ω are arranged in such an order from bottom to top column-wise
and the corresponding vector x representing the unknown image values is given by

x = [f (0, 0) · · · f (0, n − 1) f (1, 0) · · · f (1, n − 1) · · · f (n − 1, 0) · · · f (n − 1, n − 1)]T .

In general, a direction for parallel beam scanning can be represented by (q, p) for rays with slope pq , q > 0 and gcd(|p| , q) =
1, in addition to the horizontal and vertical directions.

Projection data obtained by each ray or beam provides one equation in system (1). In the case of one direction (q, − |p|)
with a negative slope − |p|q , it is known in [4,9] thatM is a (|p| + q)n by n

2 binary matrix with rank(M) = (|p| + q)n− |p| q,
in the form of

M = [M1 M2 · · · Mn],

Mi = [m
(i)
1 m

(i)
2 · · · m

(i)
n ] ∈ R

(p+q)n×n, 1 ≤ i ≤ n,

where

m(i)j =

o(i−1)|p|+(j−1)q
e|p|+q

o(n−i)|p|+(n−j)q


, 1 ≤ i, j ≤ n.

Here os represents the zero vector of dimension s and e|p|+q represents the first column of the identitymatrix of order |p|+q.
The linear dependence of the rows ofM has been studied and can be described with the following result.

Lemma 1 ([10]). The linearly dependent rows of the matrix M can be precisely located so that the removal of these rows will
result in a full row-rank matrix. The rows of M with row indices i = |p| u + qv + 1 for nonnegative integers u, v ≤ n − 1 are
maximal linearly independent rows of M.

The terminology of a reduced binary systemmatrix is naturally introduced for discussing scans alongmultiple directions.

Definition 1 ([10]). If the rows of M with row indices i ≠ |p| u + qv + 1, for any nonnegative integers u, v ≤ n − 1, are
replaced by zero rows and the corresponding components of b by zeros, the resultant system,

Ax = h, (2)

is called the reduced binary system (RBS) generated along a scanning direction (q, p). The reduced matrix A is called the
reduced binary system matrix (RBSM) generated along a scanning direction (q, p).

It is clear that the last |p|+q−1 rows of A are zero rows. More properties of the RBSM generated along a single direction
are summarized in the following Lemma 2.

Lemma 2 ([10]). The RBSM A generated along a scanning direction (q, p), where q > 0, is a binary matrix of dimension
(|p|+q)n×n2 with rank (|p|+q)n−|p| q, having |p| q zero rows. The tth row of A is a zero row if and only if t ≠ |p| u+qv+1
for any nonnegative integers u, v ≤ n − 1. Each column of A has exactly one entry aij = 1 if and only if i = |p| u + qv + 1 and
j = un + v + 1 if p < 0, or j = (n − 1 − u)n + v + 1 if p > 0, for some nonnegative integers u, v ≤ n − 1.

For scans along two distinct directions (q1, p1) and (q2, p2) with gcd(|ps| , qs) = 1, qs > 0, s = 1, 2, let A1x = h1 and
A2x = h2 be RBSs generated along the two directions, respectively. System (2) is considered with the formulation of

A =

A1
A2


and h =


h1
h2


, (3)

where A is a (|p1| + q1 + |p2| + q2)n by n2 binary matrix with rank (|p1| + q1 + |p2| + q2)n− (|p1| + |p2|)(q1 + q2), having
|p1| q1 + |p2| q2 zero rows. For convenience we define aminimal linearly dependent set in this context.

Definition 2. A linearly dependent set E is said to be minimal if every proper subset of E is linearly independent.

A full row-rank matrix can be constructed explicitly as summarized in the following lemma.

Lemma 3 ([10]). For scans along two distinct directions (q1, p1) and (q2, p2), the nonzero rows of the matrix A are partitioned
into |p1| q2 + |p2| q1 minimal linearly dependent sets. The removal of all zero rows and one row from each set will result in a full
row-rank matrix.

It is observed that every nonzero row of the matrix A lies in one and only one minimal linearly dependent set of rows.
In general, for scans along multiple directions {(qs, ps)}ks=1, the system matrix M consists of k submatrices Ms, s =

1, 2, . . . , k, generated by the k scanning directions, respectively. The corresponding matrix A is formed by k RBSMs, As’s,



X. Li et al. / Journal of Computational and Applied Mathematics 311 (2017) 529–538 531

s = 1, 2, . . . , k, where As is a RBSM generated along the sth scanning direction (qs, ps). It is known [11,4] that A ∈ Rm×n
2

with
k

s=1(|ps| qs) zero rows, wherem = n
k

s=1(|ps| + qs) and

rank(A) = n
k

s=1

(|ps| + qs) −
k

s=1

|ps|
k

s=1

qs.

It is in our interest to explicitly identify
k

s=1 |ps|
k

s=1 qs −
k

s=1(|ps| qs) nonzero rows of A such that the removal of these
rows results in a full row-rank matrix.

In the following sections, we study how to construct a full row-rank system matrix for scans along three directions. The
main contribution of this paper is to identify explicitly and efficiently the dependent rows of Awithout performing any row
operations to obtain a full row-rankmatrix. The paper is organized as follows: Section 2 develops geometric techniques and
applies them to provide an alternate proof of a known result for the system generated along two scanning directions, thus
establishing the equivalence of geometric and analytical proofs. The main result is then presented in Section 3. A procedure
for explicitly determining a minimally dependent set of rows of A is developed using a row of A3 and then applied to obtain
a full row-rank matrix. Numerical examples are presented in Section 4. Finally, concluding remarks are given in Section 5.

2. Equivalent results

The goal of this section is to develop geometric techniques to better understand established results and prove future
results. We begin by introducing terminology.

We employ the notion of a multiset [12,13] which is a generalization of a set allowing repetition of elements. The
multiplicity of an element is the number of times that element is listed in the set. We make use of the union, intersection,
and direct union as defined for multisets (see [12]). For example, if S = {a, a, a, b} and T = {a, a, b, b, c} then S ∪ T =
{a, a, a, b, b, c}, S ∩ T = {a, a, b}, and S ⊎ T = {a, a, a, a, a, b, b, b, c}. Two multisets are equal if they contain the same
elements and equivalent elements have the same multiplicity.

Definition 3. Given a RBSM A, a rowline is a line intersecting the lattice points indicated by a nonzero row in A. The set of
all lattice points intersected by a rowline l is denoted lp(l). The lattice points of a set of rowlines R is the direct union of the
set of lattice points intersected by each rowline in R, denoted lp(R) = ⊎l∈R lp(l).

As a note to readers, by Lemma 1 the lattice points along a rowline l are evenly spaced.

Definition 4. Let R be a subset of all rowlines from the RBSMs As, 1 ≤ s ≤ k. If R = R1 ∪ R2, where R1 ∩ R2 = ∅, for which
∃R1 that is the direct union of some subsets of R1 and ∃R2 that is the direct union of some subsets of R2 such that lp(R1) =
lp(R2) then R is said to be balanced. Otherwise, R is said to be unbalanced. If R is balanced and every proper subset of R is
unbalanced we say that R is minimally balanced.

Lemma 4. Let VAs be a subset of row vectors from the RBSMs As, 1 ≤ s ≤ k, and let RAs be the set of corresponding rowlines from
As. Define V = ∪ks=1 VAs and R = ∪

k
s=1 RAs . Then V is a minimal linearly dependent set if and only if R is minimally balanced.

Proof. We first show a set of row vectors being linearly dependent is equivalent to the set of corresponding rowlines being
balanced. Let R be a balanced set of rowlines from the RBSMs As, 1 ≤ s ≤ k. By definition, R = R1 ∪ R2, where R1 ∩ R2 = ∅,
for which ∃R1 that is the direct union of subsets of R1 and ∃R2 that is the direct union of subsets of R2 such that lp(R1) =
lp(R2). Using the one-to-one correspondence between the rowlines and nonzero row vectors of As, there exist disjoint sets
of row vectorsV1 andV2 corresponding to the setsR1 andR2, including multiplicity, such that

v∈V1
v =


w∈V2

w. (4)

Letting V1 and V2 be the setsV1 andV2 withoutmultiplicity of elements, Eq. (4) is equivalent to saying V = V1∪V2 is linearly
dependent.

We now show that a set of row vectors being minimally linearly dependent is equivalent to the corresponding set of
rowlines being minimally balanced. Assume that R is now minimally balanced. Using the one-to-one correspondence, any
V ′ ( V corresponds to some R′ ( R. By the minimality of R, R′ is unbalanced which is equivalent to V ′ being linearly
independent. Thus, V is a minimal linearly dependent set. �

Given two RBSMs, A1 and A2, with scanning directions (q1, p1) and (q2, p2), respectively, we first introduce a procedure
for generating a minimally balanced set of rowlines. For convenience we let (q0, p0) = (q2, p2). The notation d(l, l′) is used
to represent the perpendicular distance between two parallel rowlines l and l′.

Procedure 1 (Minimal Balanced Set Generated with a Rowline from A2).
1. Input: two RBSMs A1 and A2; two directions (q1, p1) and (q2, p2); a rowline l2 from A2.
2. Choose a rowline l1 from A1 that intersects l2 at a lattice point.



532 X. Li et al. / Journal of Computational and Applied Mathematics 311 (2017) 529–538

Fig. 1. Minimally balanced set of rowlines with opposite slope signs on the lattice Ω .

Fig. 2. Minimally balanced set of rowlines with the same slope sign on the lattice Ω .

3. for i = 0 to 1

generate Ri+1 = {l: l ∥ li+1, d(l, li+1) =

k qipi+1−piqi+1p2i +q2i
, for any k ∈ Z s.t. l intersects Ω}.

end
4. Output: R = R1 ∪ R2.

Procedure 1 will be generalized into Procedure 2 for the case of multiple directions in the next section. It is pointed out
that the understanding of Procedure 1 is helpful for establishing Procedure 2.

We now provide an alternate proof for Lemma 3 using the notion of rowlines and Procedure 1.

Proof of Lemma 3. We then consider two possible cases for the problem.
Case 1: Scanning directions have opposite slope signs.
Consider scanning directions (q1, p1) and (q2, p2) for the RBSMs A1 and A2, respectively, where p1/q1 < 0 < p2/q2.

Following Procedure 1, we generate a minimally balanced set, R = R1 ∪ R2, using the rowline from A2 passing through the
point (0, |p1|) on the lattice Ω , as displayed in Fig. 1.

For each lattice point P inside of the shaded region in Fig. 1, we can use the rowline from A2 that intersects P to create a
minimally balanced set of rowlines disjoint from the previous set using Procedure 1. Thus, the number of disjoint minimally
balanced sets is |p1|q2 + |p2|q1. In addition to the zero rows, the rows from A2 that need to be removed correspond to the
rowlines from A2 that pass through the shaded region and one of the rowlines from A2 along the edge of the shaded region.

Case 2: Scanning directions have same slope sign.
Consider scanning directions (q1, p1) and (q2, p2) for the RBSMs A1 and A2, respectively, where p1/q1 < p2/q2. Using

Procedure 1, any rowline selected from A2 that intersects the point (u, v) in the region where u < q1, v < |p2| or the region
where u > n − q1, v > n − |p2| will generate a minimally balanced set containing one rowline from A1 and one rowline
from A2, as illustrated in Fig. 2. This results in 2|p2|q1 rowlines of A2 that intersect a lattice point in the shaded regions from
Fig. 2.

If we use a rowline from A2 that does not intersect one of the shaded regions in Fig. 2 then Procedure 1 will generate
disjoint minimally balanced sets similar in form to the sets from Case 1. In this instance, we use the same idea from Case 1
yielding an additional |p1|q2 − |p2|q1 disjoint minimally balanced sets of rowlines. Finally, we remove one row from A2
corresponding to a rowline from A2 in each disjoint minimally balanced set. This results in removing a total of |p1|q2+|p2|q1
rows from A2. �



X. Li et al. / Journal of Computational and Applied Mathematics 311 (2017) 529–538 533

It should be noted that in the case where the scanning directions have opposite slope signs we can remove any
|p1|q2 + q1|p2| consecutive nonzero rows from A2 having an index in the set W together with the zero rows of A1 and
A2, whereW is given by

W = {i = u|p2| + vq2 + 1 : n − q1 ≤ u ≤ n − 1, n − |p2| ≤ v ≤ n − 1}.

The ideas from the geometric proofs of Lemmas 3 and 4 will be used in the following section to prove the main result in
three scanning directions.

3. Main results

Let

A = [A1; A2; A3] ∈ Rm×n
2

(5)

be a systemmatrix generated by the line projectionmodel for reconstruction of an n×n 2-dimensional image, where As’s are
RBSMs generated along three scanning directions (qs, ps), qs > 0 with gcd (qs, |ps|) = 1, s = 1, 2, 3, respectively. Without
loss of generality, we assume that the slopes are in ascending order, i.e.,

p1
q1

<
p2
q2

<
p3
q3

, qs > 0, s = 1, 2, 3.

Then

m =
3

s=1

(qs + |ps|)n and rank (A) =
3

s=1

(qs + |ps|)n −


3

s=1

qs

 
3

s=1

|ps|


= m1.

We explicitly construct a full rank matrix F ∈ Rm1×n
2
by the removal of certain (

3
s=1 qs)(

3
s=1 |ps|) rows from A in this

section.
With an application of Lemma 3, we have the following remark.

Remark 1. If T = {v1, v2, . . . , vt} is a subset of rows of A3, where t = |p3|(q1 + q2) + (|p1| + |p2|)q3, such that all rows
vi’s in T are linear combinations of other rows of A then the removal of all rows of T from A3, |p1|q2 + |p2|q1 rows of A2 in
Lemma 3, and all zero rows of Awill result in a desired full rank matrix.

Furthermore, we have the following equivalent lemma in terms of minimally balanced sets:

Lemma 5. Assume that a set of t rowlines from A3 is denoted by D = {r1, r2, . . . , rt}, where t = |p3|(q1 +q2)+ (|p1|+ |p2|)q3,
and all the other rowlines from A are denoted by {rt+1, rt+2, . . . , rm}. Let Sj be a minimally balanced set of A containing the
rowline rj ∈ D, respectively, j = 1, 2, . . . , t, such that

{rj+1, rj+2, . . . , rj+t−1} ∩ Sj = ∅, for j = 1, 2, . . . , t. (6)

Then the removal of the rows of A3 corresponding to the rowlines in D, |p1|q2 + |p2|q1 rows of A2 in Lemma 3, and all zero rows
of A will result in a full row-rank matrix.

Proof. We label the row vectors of A corresponding to the rowline rj of A as vj, j = 1, 2, . . . ,m. It follows from (6) that
vj is a linear combination of v1, . . . , vj−1, vj+t , . . . , vm, for 1 ≤ j ≤ t . By induction it can be shown that {v1, . . . , vt} ⊂
Span{vt+1, . . . , vm}. We apply Remark 1 to complete the proof. �

For Lemma 5, we will focus on constructing a set of rowlines, D, from A3 and the corresponding minimally balanced sets
Sj’s satisfying (6) in this section. For convenience, we denote

A0 = A3, and Ak = Amod(k,3) for k ≥ 3.

Let H be a hexagon P1 . . . P6 such that the vertices, Pi, are lattice points of Ω in counterclockwise order satisfying

−
−−−→
PsPs+1 =

−−−−→
Ps+3Ps+4 = qsi + psj, s = 1, 2, 3,

where P7 = P1 and i, j are the unit vectors of the axes in the uv-plane. See Fig. 3 for an illustration. Before describing
a procedure to generate a minimally balanced set using a rowline from A3, we introduce some necessary notations, for
i = 1, 2, . . . , 6:

li: a rowline passing through the side PiPi+1.
Hi: an open half plane bounded by li excluding the hexagon H .
Hi: the closure of Hi.
di,+: the perpendicular distance from Pi+2 to li.
di,−: the perpendicular distance from Pi−1 to li.
Di: a set of distances, {kdi,+ + hdi,− : k, h nonnegative integers}.
d(l, li): the distance between two parallel rowlines l and li.
Oi: The open region in Ω located between li and li+3.



534 X. Li et al. / Journal of Computational and Applied Mathematics 311 (2017) 529–538

Fig. 3. Hexagon and a lattice point Q .

Fig. 4. Some rowlines in ∪i=1,3,5 Ri or ∪i=2,4,6 Ri .

Procedure 2 (Minimally Balanced Set Generated with a Rowline from A3).

1. Input: RMSMs Ai, directions (qi, pi), i = 1, 2, 3; a rowline l from A3.
2. Construct a hexagon H = P1P2 . . . P6 such that P6P1 lies on l.
3. for i = 1 to 6

generate Ri = {l: l ∥ li, located in Hi, intersecting Ω , and d(l, li) ∈ Di}.
end

4. Output: R = ∪6i=1 Ri.

Procedure 2 is a geometric interpretation of a minimally balanced set generated from a nonzero row of A3. It should be
noted that there is no rowline in the set R that intersects a lattice point in the region ∩3s=1 Os, which is equivalent to the
interior of hexagon H . We now prove that the output of Procedure 2 is a minimally balanced set.

Theorem 6. The set of rowlines, R = ∪6i=1 Ri, yielded by Procedure 2, is minimally balanced.

Proof. We first show that

R ⊂ S, (7)

where S is a minimally balanced set containing the rowline li, 1 ≤ i ≤ 6. For each i, 1 ≤ i ≤ 6, we define two sets of
rowlines:

Ri,+ = {l : l ∥ li, located in Hi, intersecting Ω, and d(l, li) = kdi,+, k ≥ 0}; (8)

Ri,− = {l : l ∥ li, located in Hi, intersecting Ω, and d(l, li) = kdi,−, k ≥ 0}.

The rowlines in Ri,+ and Ri+1,− intersect at lattice points of Ω . Since S is a minimally balanced set we have

Ri,+ ∪ Ri+1,− ⊂ S, i = 1, . . . , 6.

Next, for a fixed i, we denote l1i,+ as the rowline in Ri,+ with k = 1 (8). There exists a lattice point Q on the rowline l
1
i,+

located in the open region Oi−1. See Fig. 4. By a similar argument, a rowline parallel to li−1 in Hi−1 must be an element of S.
Thus, the rowline in Ri with distance di,+ + di,− must be an element of S. By induction, it can be shown that Ri is a subset of
S which implies that (7) holds.

We now show that R is a balanced set. In other words, we prove that

lp(∪i=1,3,5Ri) = lp(∪i=2,4,6Ri). (9)



X. Li et al. / Journal of Computational and Applied Mathematics 311 (2017) 529–538 535

Recall that di,+ and di,− are the perpendicular distances from Pi+2 and Pi−1 to li, respectively. We claim that there exist
smallest positive integers ki and hi such that

di = kidi,+ = hidi,−. (10)

For simplicity, we consider the case of p1q1 <
p2
q2

< 0 < p3q3 , qs > 0, s = 1, 2, 3. Using geometry, it can be shown that

d1,+ =
−p1q2 + p2q1

p21 + q
2
1

and d1,− =
−p1q3 + p3q1

p21 + q
2
1

.

So d1,+d1,− =
|p1q2−p2q1|
|p1|q3+p3q1

. Let

k1 =
−p1q3 + p3q1

gcd(−p1q2 + p2q1, −p1q3 + p3q1)
and h1 =

−p1q2 + p2q1
gcd(−p1q2 + p2q1, −p1q3 + p3q1)

.

Then k1 and h1 are smallest positive integers such that

d1 = k1d1,+ = h1d1,−.

The claim (10) can be proved for each i = 1, 2, . . . , 6, in an analogous way.
The rowline l∗ ∈ Ri,+ ∩ Ri,− with d(l∗, li) = di provided in the claim intersects rowlines in both Hi−1 and Hi+1. Thus,

it needs to be included twice in the setRi, requiring the use of a direct union. Additionally, the rowline l∗ ∈ Ri,+ ∩ Ri,−
with di ≤ d(l∗, li) < 2di needs to be included in the set Ri twice. In general, the rowline l∗ ∈ Ri,+ ∩ Ri,− with
(k − 1)di ≤ d(l∗, li) < kdi needs to be included in the setRi k times, requiring the use of a direct union.

In Fig. 4, all rowlines in Ri, for odd i, are indicated by solid rowlines while all rowlines in Ri, for even i, are represented by
dashed rowlines. In the intersection of two closed sets H1 ∩ H3, we have

lp(∪i=1,3,5Ri) = (lp(R1) ∩ lp(R2)) ⊎ (lp(R2) ∩ lp(R3)) = lp(∪i=2,4,6Ri),
since H4 ∪ H5 ∪ H6 and H1 ∩ H3 are disjoint. In general, we have

lp(∪i=1,3,5Ri) = lp(∪i=2,4,6Ri), on ∪6i=1(Hi ∩ Hi+2).
Furthermore, by the previous argument, every lattice point from the set lp(R) in the open region ∪3s=1 Os is the intersection
of rowlines from disjoint sets ∪i=1,3,5Ri and ∪i=2,4,6Ri. Note that ∪3s=1 Os is the complement of ∪6i=1(Hi ∩ Hi+1). Therefore,
(9) is proved.

Finally, the removal of any rowline of R results in the loss of the balance of R yielding that R is minimally balanced. �

The rowline l used in Procedure 2 to generate a minimal balanced set is selected to be l6. A special case may occur when
there is no hexagon located in Ω for a given rowline l from A3. (For example, see the proof of Case 2 in Theorem 7.) In such
an instance, using l, we first construct part of a hexagon consisting of two or three consecutive rowlines, where the first and
last edges have one vertex of the hexagon outside of Ω . Using these rowlines, a minimally balanced set is formed.

We now show the main result.

Theorem 7. Let A be given in (5). One can explicitly determine |p3|(q1 + q2) + (|p1| + |p2|)q3 rows of A3 and |p1|q2 + |p2|q1
rows of A2 such that the removal of those rows and all zero rows of A will result in a full rank matrix.

Proof. We consider the following two cases. The remaining cases can be proved in an analogous way.
Case 1. Scanning directions have two negative slopes and one positive slope.
Assume that

p1
q1

<
p2
q2

< 0 <
p3
q3

, qs > 0, s = 1, 2, 3. (11)

We define a hexagon H = P1P2 . . . P6 using the rowline l = l6 from A3 passing through the points P6(q1 + q2, 0) and
P1(q1 + q2 + q3, |p3|) on the lattice Ω . See Fig. 5. Let D be the union of l6 and RA3 in the open region O3. We claim

|D| = (q1 + q2)|p3| + q3(|p1| + |p2|). (12)

In fact, there are q1|p3| + q3|p1| − 1 and q2|p3| + q3|p2| − 1 rowlines in RA3 that intersect the open parallelogram regions
P6P1P2Q and P2P3P4Q in the hexagon H , respectively. Using each rowline, we generate a minimally balanced set. Distinct
rowlines in these regions generate different minimally balanced sets. Including the rowline l6 and the rowline intersecting
lattice point P2 concludes the proof of (12).

We construct a set of minimally balanced sets of A, {Sj}tj=1, using all rowlines in D by Procedure 2. Moreover, (6) holds
and we complete the proof with an application of Lemma 5.



536 X. Li et al. / Journal of Computational and Applied Mathematics 311 (2017) 529–538

Fig. 5. Hexagon and a point Q in Case 1 of Theorem 7.

Fig. 6. Hexagon and a point Q in Case 2 of Theorem 7.

Case 2. Scanning directions have all negative slopes.
Assume that

p1
q1

<
p2
q2

<
p3
q3

< 0, qs > 0, s = 1, 2, 3. (13)

We construct a hexagon H = P1P2 . . . P6 using the rowline l = l6 from A3 passing through the points P6(q1 + q2, |p3|) and
P1(q1 + q2 + q3, 0) on Ω . See Fig. 6. Then P4 = (0, |p1| + |p2| + |p3|). Let D1 be the union of l6 and rowlines from A3 in the
open region O3. We claim

|D1| = q3(|p1| + |p2|) − (q1 + q2)|p3|. (14)

We find that there are q3|p1| − q1|p3| − 1 and q3|p2| − q2|p3| − 1 rowlines from A3 that intersect the open parallelogram
regions P6P1P2Q and P2P3P4Q in the hexagon H , respectively. Including the rowline l6 and the rowline intersecting lattice
point P2 proves (14).

Any rowline from A3 that passes through a lattice point (u, v) in the region where u < q1, v < |p3| or the region where
u ≥ n − q1, v ≥ n − |p3| will generate a minimally balanced set containing one rowline from A1 and one rowline from A3.
Let D2 be the set of such rowlines from A3. Then

|D2| = q1|p3|.

For each lattice point Q6 in the region where q1 ≤ u < q1 + q2, v < |p3|, we set segments Q4Q5Q6Q1 such that

QiQi+1//PiPi+1 and QiQi+1 = |PiPi+1|, i = 4, 5, 6.

Then both Q4 and Q1 are out of Ω . So the minimal balanced set generated from the rowline from C passing through Q6
contains only one rowline from A3 and other rowlines from A2 and A3. Let D3 be the set of those rowlines from A3. Then

|D3| = q2|p3|.

There are q2|p3| such minimal balanced sets. They are disjoint from the minimal balanced sets generated by rowlines in
D1 ∪ D2.

We canmake a similar argument for the region where u ≥ n− (q1 +q2), v ≥ n−|p3|. Let D4 be the set of those rowlines
from A3. Then

|D4| = (q1 + q2)|p3|.

Letting D = D1 ∪ D2 ∪ D3 ∪ D4 yields that

|D| = (q1 + q2)|p3| + q3(|p1| + |p2|).

Applying Lemma 5 completes the proof. �



X. Li et al. / Journal of Computational and Applied Mathematics 311 (2017) 529–538 537

Remark 2. In Case 1, particularly, any (|p1| + |p2|)q3 + |p3|(q1 + q2) consecutive nonzero rows of A3 with index in the set
W1 can be selected as rows of A3 to be removed, where

W1 = {|p3|q3 + 1, |p3|q3 + 2, . . . , (|p3| + q3)n − (|p3| + q3 − 1) − |p3|q3}.

On the other hand, in Case 2, particularly, any (|p1| + |p2|)q3 − |p3|(q1 + q2) consecutive nonzero rows of A3 with index in
the setW2 can be removed with all nonzero rows of A3 with index inW3 ∪ W4 where

W2 = {|p3|(q1 + q2 + q3) + 1, . . . , (|p3| + q3)n − (|p3| + q3 − 1) − |p3|(q1 + q2 + q3)},
W3 = {i = u|p3| + vq3 + 1 : 0 ≤ u ≤ q1 + q2 − 1, 0 ≤ v ≤ |p3| − 1},
W4 = {i = u|p3| + vq3 + 1 : n − (q1 + q2) ≤ u ≤ n − 1, n − |p3| ≤ v ≤ n − 1}. (15)

4. Examples

In this section, we demonstrate the main results in Section 3 by considering two numerical examples as representatives
of same slope signs and different slope signs using three slopes. Consider the scanning of an image with size 24 × 24 along
three directions (qi, pi), i = 1, 2, 3, where the slopes of projections in real cases are approximated by rational numbers. For
simplicity, numerates and denominates of rational numbers are chosen small integers in absolute value. The systemmatrix
in (2) is defined as in (5).

Example 1. The first example is selected as an experiment for the case of different slope signs. Suppose that the three
directions are (q1, p1) = (4, −3), (q2, p2) = (3, −2), and (q3, p3) = (2, 3). The matrix A is of size 408 × 576 with
rank(A) = 336.

The dimensions of submatrices A1, A2, and A3 are 168×576, 120×576, and 120×576, respectively [4]. The submatrices
A1, A2, and A3 have 6, 12, and 6 zero rows, respectively. In addition to the 24 zero rows, the matrix A has 48 nonzero rows
that should be removed to result in a full row-rank matrix F :

(i) |p1| q2 + |p2| q1 = 17 nonzero dependent rows from A2 by Lemma 3: 1, 3-8, 10, 15, 107, 109-114, 116.
(ii) |p3| (q1 + q2) + (|p1| + |p2|)q3 = 31 consecutive nonzero dependent rows from A3 by Remark 2, for example, rows

7 − 37.

The numerical experiment verifies that the removal of the 24 zero rows and above nonzero rows in A2 and A3 results in
a full row-rank matrix F with rank(F) = 336.

Example 2. Suppose the three directions with same slope sign are (q1, p1) = (2, −3), (q2, p2) = (4, −3), and (q3, p3) =
(3, −2). The matrix A is of size 408 × 576 with rank(A) = 336.

In this case, A1, A2, and A3 are 120×576, 168×576, and 120×576 submatrices having 6, 12, and 6 zero rows, respectively.
The matrix A is converted to a full row-rank matrix F after the removal of the following rows:

(i) 24 zero rows from A.
(ii) |p1| q2 + |p2| q1 = 18 nonzero dependent rows from A2 by Lemma 3: 1, 4, 5, 8, 9, 12, 19-24, 151, 154, 155, 158, 159,

162.
(iii) |p3| (q1 + q2) + (|p1| + |p2|)q3 = 30 nonzero dependent rows from A3 with indices in W2 ∪ W3 ∪ W4, by Theorem 7

and Remark 2:

W2 = {19, 20, 21, 22, 23, 24},
W3 = {i = 2u + 3v + 1 : 0 ≤ u ≤ 5, 0 ≤ v ≤ 1} = {1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14},
W4 = {i = 2u + 3v + 1 : 18 ≤ u ≤ 23, 22 ≤ v ≤ 23}

= {103, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 116}.

The numerical experiment verifies that the removal of above rows results in a full row-rank matrix F with rank(F)
= 336.

5. Conclusion

In the case of three scanning directions, it is observed that every nonzero dependent row of the systemmatrix Amay lie
inmore than oneminimal linearly dependent set of rows. The structure of aminimal linearly independent set and a partition
for those minimal linearly independent sets are more complicated than the case of two scanning directions.

For scans along more than two directions, we first show the equivalence of a minimal linearly dependent set of rows of
A and the corresponding minimally balanced set of rowlines. In the case of three scanning directions, our work in this paper
provides the exact locations of the linearly dependent rows of the system matrix A.



538 X. Li et al. / Journal of Computational and Applied Mathematics 311 (2017) 529–538

It is remarked that the result for three directions can be naturally extended to arbitrarily many scanning directions.
Thus, theoretically, the linearly dependent rows of the system matrix A generated by scans along multiple directions can
be explicitly and efficiently identified explicitly and a full row-rank matrix can be obtained after the removal of these rows.
Therefore, software packages requiring a full row-rank system matrix can be adopted to reconstruct an image. Meanwhile,
the cost of computation is reduced by using a full row-rank matrix.

Acknowledgments

The authors thank the reviewers and editors for their valuable comments and suggestions. The authors also thank Dr.
HuaWang and Dr. YanWu for the discussion of the topic. It is acknowledged that J. Zhu was partially supported by the NSFC
under Grant No. 61272338.

References

[1] A.C. Kak, Malcolm Slaney, Principles of Computerized Tomographic Imaging, Society of Industrial and Applied Mathematics, Philadelphia, 2001.
[2] X. Li, J. Zhu, A note of reconstruction algorithm of the strip-based projection model for discrete tomography, J. X-Ray Sci. Technol. 16 (2008) 253–260.
[3] Y. Ye, J. Zhu, G. Wang, Linear diophantine equations for discrete tomography, J. X-Ray Sci. Technol. 10 (2001) 59–66.
[4] J. 